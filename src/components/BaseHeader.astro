---
import { Image } from "astro:assets";
import { getLangFromUrl, useTranslations } from "@/i18n/utils";
import BaseButton from "@/components/BaseButton.astro";
import HeaderLocale from "@/components/header/HeaderLocale.astro";
const lang = getLangFromUrl(Astro.url)
const t = useTranslations(lang)
const isBlog =Astro.url.pathname.includes('blog')

import logo from "@/images/logo.svg";
const mainLink = lang === 'ru' ? '/' : `/${lang}`
const blogLink = lang === 'ru' ? '/blog' : `/${lang}/blog`
const functionalityLink = lang === 'ru' ? '/#functionality' : `/${lang}#functionality`
const costLink = lang === 'ru' ? '/#cost' : `/${lang}#cost`
---

<header class="base-header bg-white z-50 shadow-xl">
  <div class="max-w-[1440px] mx-auto px-[3.88vw] sm:px-4 lg:px-20 flex">
    <button
      class="menu-btn block md:hidden relative"
      type="button"
      aria-label="Menu"
      aria-controls="navigation"
    >
      <span class="menu-btn__block">
        <span class="menu-btn__inner"></span>
      </span>
    </button>

    <div
      class="header__wrapper flex items-center py-4 w-full justify-between ml-4 m:ml-0"
    >
      <div class="flex items-center">
        <a href={mainLink} class="flex flex-shrink-0">
          <Image
            src={logo}
            alt="image-logo"
            class="rounded-none h-[20px] m:h-[25px]"
          />
        </a>

        <nav class="hidden md:!block ml-20">
          <ul class="flex flex-row m:gap-14 z-30">
            <li>
              <a href={functionalityLink} class="text-pre-black"
                >{t("header.nav.functionality")}</a
              >
            </li>
            <li>
              <a href={costLink} class="text-pre-black">{t("header.nav.price")}</a>
            </li>
            <li>
              <a href={blogLink} class={`text-pre-black ${isBlog ? '!text-blue':''}`}>{t("header.nav.blog")}</a>
            </li>
          </ul>
        </nav>
      </div>

      <div class="flex flex-row m:flex-row-reverse gap-6">
        <HeaderLocale />
        <div class="flex gap-4">
          <BaseButton variant="secondary" classes="uppercase m:!text-m">
            <a href="https://igame.by/panel">
              {t("header.login")}
            </a>
          </BaseButton>
          <BaseButton
            classes="hidden m:!block uppercase m:!text-m js-registration-btn"
            >{t("header.register")}</BaseButton
          >
        </div>
      </div>
    </div>
  </div>
</header>

<div
  id="burger-menu"
  class="hidden top-0 left-0 flex-col bg-white w-full z-30 fixed pb-20"
>
  <div class="px-5 py-[24px] flex items-center justify-center">
    <BaseButton classes="w-[206px] uppercase js-registration-btn" size="xl"
      >{t("header.register")}</BaseButton
    >
  </div>
  <a
    href={functionalityLink}
    class="font-bold text-main-black text-[20px] my-5 ml-6 active:text-blue-dark w-fit flex items-center"
    >{t("header.nav.functionality")}</a
  >
  <a
    href={costLink}
    class="font-bold text-main-black text-[20px] my-5 ml-6 active:text-blue-dark w-fit flex items-center"
    >{t("header.nav.price")}</a
  >
  <a
    href={blogLink}
    class={`font-bold text-main-black text-[20px] my-5 ml-6 active:text-blue-dark w-fit flex items-center ${isBlog ? '!text-blue':''}`}
    >{t("header.nav.blog")}</a
  >
  <a
    href="https://www.instagram.com/igame2by/"
    class="font-bold text-main-black text-[20px] my-5 ml-6 active:text-blue-dark w-fit flex items-center group"
    >{t("header.nav.insta")}
    <svg
      width="22"
      height="22"
      viewBox="0 0 22 22"
      fill="none"
      class="ml-2"
      xmlns="http://www.w3.org/2000/svg"
    >
      <path
        class="group-hover:fill-blue group-active:text-blue-dark"
        d="M11.0002 2.07333C13.9077 2.07333 14.252 2.08439 15.4002 2.13678C16.4619 2.18524 17.0384 2.36262 17.4222 2.5117C17.9304 2.70923 18.2932 2.94523 18.6742 3.32625C19.0552 3.70726 19.2912 4.07004 19.4887 4.57826C19.6378 4.962 19.8152 5.53856 19.8637 6.60017C19.916 7.7484 19.9271 8.09277 19.9271 11.0002C19.9271 13.9077 19.916 14.2521 19.8637 15.4003C19.8152 16.4619 19.6378 17.0385 19.4887 17.4222C19.2912 17.9304 19.0552 18.2932 18.6742 18.6742C18.2932 19.0552 17.9304 19.2912 17.4222 19.4887C17.0384 19.6379 16.4619 19.8152 15.4002 19.8637C14.2522 19.9161 13.9078 19.9271 11.0002 19.9271C8.09255 19.9271 7.74819 19.9161 6.60017 19.8637C5.53852 19.8152 4.96196 19.6379 4.57826 19.4887C4.07 19.2912 3.70722 19.0552 3.32621 18.6742C2.94519 18.2932 2.70919 17.9304 2.5117 17.4222C2.36258 17.0385 2.18519 16.4619 2.13674 15.4003C2.08435 14.2521 2.07329 13.9077 2.07329 11.0002C2.07329 8.09277 2.08435 7.7484 2.13674 6.60021C2.18519 5.53856 2.36258 4.962 2.5117 4.57826C2.70919 4.07004 2.94519 3.70726 3.32621 3.32625C3.70722 2.94523 4.07 2.70923 4.57826 2.5117C4.96196 2.36262 5.53852 2.18524 6.60013 2.13678C7.74836 2.08439 8.09272 2.07333 11.0002 2.07333ZM11.0002 0.111328C8.04293 0.111328 7.67216 0.123863 6.51074 0.176855C5.3517 0.229761 4.56019 0.413806 3.86754 0.683002C3.1515 0.961275 2.54425 1.3336 1.9389 1.93895C1.33356 2.54429 0.961232 3.15154 0.682959 3.86758C0.413763 4.56024 0.229717 5.35175 0.176812 6.51079C0.12382 7.67216 0.111328 8.04297 0.111328 11.0002C0.111328 13.9575 0.12382 14.3283 0.176812 15.4897C0.229717 16.6487 0.413763 17.4402 0.682959 18.1329C0.961232 18.8489 1.33356 19.4562 1.9389 20.0615C2.54425 20.6669 3.1515 21.0392 3.86754 21.3175C4.56019 21.5867 5.3517 21.7707 6.51074 21.8236C7.67216 21.8766 8.04293 21.8891 11.0002 21.8891C13.9575 21.8891 14.3283 21.8766 15.4896 21.8236C16.6487 21.7707 17.4402 21.5867 18.1329 21.3175C18.8489 21.0392 19.4561 20.6669 20.0615 20.0615C20.6668 19.4562 21.0392 18.8489 21.3174 18.1329C21.5866 17.4402 21.7707 16.6487 21.8236 15.4897C21.8766 14.3283 21.8891 13.9575 21.8891 11.0002C21.8891 8.04297 21.8766 7.67216 21.8236 6.51079C21.7707 5.35175 21.5866 4.56024 21.3174 3.86758C21.0392 3.15154 20.6668 2.54429 20.0615 1.93895C19.4561 1.3336 18.8489 0.961275 18.1329 0.683002C17.4402 0.413806 16.6487 0.229761 15.4896 0.176855C14.3283 0.123863 13.9575 0.111328 11.0002 0.111328ZM11.0002 5.40863C7.91205 5.40863 5.40859 7.91209 5.40859 11.0002C5.40859 14.0884 7.91205 16.5918 11.0002 16.5918C14.0883 16.5918 16.5918 14.0884 16.5918 11.0002C16.5918 7.91209 14.0883 5.40863 11.0002 5.40863ZM11.0002 14.6299C8.99562 14.6299 7.37054 13.0048 7.37054 11.0002C7.37054 8.99566 8.99562 7.37059 11.0002 7.37059C13.0048 7.37059 14.6298 8.99566 14.6298 11.0002C14.6298 13.0048 13.0048 14.6299 11.0002 14.6299ZM18.1194 5.18771C18.1194 5.90937 17.5344 6.4944 16.8127 6.4944C16.0911 6.4944 15.506 5.90937 15.506 5.18771C15.506 4.46605 16.0911 3.88107 16.8127 3.88107C17.5344 3.88107 18.1194 4.46605 18.1194 5.18771Z"
        fill="#18232F"></path>
    </svg>
  </a>
  <a
    href="https://t.me/igame2by_bot"
    class="font-bold text-main-black text-[20px] my-5 ml-6 active:text-blue-dark w-fit flex items-center group"
    >{t("header.nav.telegram")}
    <svg
      width="19"
      height="18"
      class="ml-2"
      viewBox="0 0 19 18"
      fill="none"
      xmlns="http://www.w3.org/2000/svg"
    >
      <path
        class="group-hover:fill-blue group-active:text-blue-dark"
        d="M18.2062 2.15946L15.0565 15.2625C14.9083 15.8796 14.2228 16.1975 13.6608 15.9045L9.6772 13.8287L7.79358 16.9393C7.28105 17.7871 5.98413 17.4193 5.98413 16.4281V12.9621C5.98413 12.6941 6.09524 12.4385 6.28672 12.2515L14.0499 4.77123C14.0437 4.67772 13.9448 4.59674 13.8461 4.6652L4.58243 11.1731L1.46986 9.55234C0.741186 9.17205 0.772065 8.10607 1.52541 7.77576L16.8725 1.02496C17.6074 0.700752 18.398 1.3678 18.2065 2.1594L18.2062 2.15946Z"
        fill="#18232F"></path>
    </svg>
  </a>
</div>

<script>
  const burgerMenuFunction = () => {
    const headerContainer = document.querySelector(".base-header");
    const burgerBtn = headerContainer.querySelector(".menu-btn");
    const header = document.querySelector(".header__wrapper");

    const navLink = headerContainer.querySelectorAll(".nav-menu__link");

    const menu = document.querySelector("#burger-menu");

    function openBurger(e) {
      if (!menu.classList.contains("flex")) {
        burgerBtn.classList.add("is-active");
        menu.classList.add("flex");
        menu.style.display = "flex";
        menu.style.top = header.getBoundingClientRect().height + "px";
        e.stopPropagation();
      }
    }

    function closeBurger(e) {
      if (menu.classList.contains("flex")) {
        burgerBtn.classList.remove("is-active");
        menu.classList.remove("flex");
        menu.style.display = "none";
        e.stopPropagation();
      }
    }

    const handleBurgerClick = (e) => {
      if (menu.classList.contains("flex")) {
        closeBurger(e);
      } else {
        openBurger(e);
      }
    };

    window.addEventListener("scroll", closeBurger);
    document.addEventListener("click", closeBurger, true);
    burgerBtn.addEventListener("click", handleBurgerClick);
  };
  burgerMenuFunction();
</script>
